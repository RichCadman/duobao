(function(E){var F={templateSettings:{TemplateRegQueue:[{reg:/^\s*|\s$/g,func:""},{reg:/\r|\n|\t|\/\*[\s\S]*?\*\//g,func:""},{reg:/'|\\/g,func:"\\$&"},{reg:/\{#=([\s\S]+?)#\}/g,func:function(B,A){return"'+("+D(A)+")+'"}},{reg:/\{##([\s\S]+?)#\}/g,func:function(B,A){return"';"+D(A)+"res+='"}},{reg:/\{#\?(\?)?\s*([\s\S]*?)\s*#\}/g,func:function(A,B,C){return B?(C?"';}else if("+D(C)+"){res+='":"';}else{res+='"):(C?"';if("+D(C)+"){res+='":"';}res+='")}},{reg:/\{#~\s*(?:#\}|([\s\S]+?)\s*\:\s*([\w$]+)\s*(?:\:\s*([\w$]+))?\s*#\})/g,func:function(A,C,B,H){if(!C){return"';}} res+='"}return"';if("+C+"){for(var "+B+","+H+"=0,len="+C+".length;"+B+"="+C+"["+H+"],"+H+"<len;"+H+"++){res+='"}}],PackagingRegQueue:[{reg:/^([\s\S]+)$/g,func:"var res ='$1';return res;"},{reg:/(\s|;|\}|^|\{)\s*res\s*\+\s*=\s*'\s*'\s*;/g,func:"$1"},{reg:/\+'\s*'/g,func:""},{reg:/(\s|;|\}|^|\{)res\+='\s*'\+/g,func:"$1res+="}],varname:"D"}};function D(A){return A.replace(/\\('|\\)/g,"$1")}F.tmpl=function(L){var M=L,O=F.templateSettings,P=O.TemplateRegQueue.concat(O.PackagingRegQueue);for(var A,B=0,C=P.length;B<C;B++){A=P[B];M=M.replace(A.reg,A.func)}try{return new Function(O.varname,M)}catch(N){}};if(typeof module!=="undefined"&&module.exports){module.exports=F}else{if(typeof define==="function"&&define.amd){define(function(){return F})}else{E.lazyT=F}}}(this));var Bitauto=Bitauto||{};(function(J,H){J.Bitauto=J.Bitauto||{};J.Bitauto.Login=J.Bitauto.Login||{};var I={callScript:function(B,C){var A=document.getElementsByTagName("head")[0],D=document.createElement("script");D.setAttribute("type","text/javascript");D.setAttribute("src",B);D.onload=D.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){C&&C();D.onload=D.onreadystatechange=null;D.parentNode.removeChild(D)}};A.appendChild(D)},LoadJs:(function(){var A={LoadedRecords:[],head:document.getElementsByTagName("head")[0],ExecJs:function(N,C){var F=false;for(var D=0,E=A.LoadedRecords.length;D<E;D++){if(A.LoadedRecords[D]===N){F=true}}if(!F){A.LoadedRecords.push(N);var B=document.createElement("script");B.setAttribute("type","text/javascript");B.setAttribute("charset","UTF-8");B.setAttribute("src",N);B.onload=B.onreadystatechange=function(){if((!this.readyState||this.readyState==="loaded"||this.readyState==="complete")){B.onload=B.onreadystatechange=null;B.onloadDone=true;C&&C(N);B.parentNode.removeChild(B)}};A.head.appendChild(B)}else{C&&C(N)}}};return A})(),extend:function(D,B,C){for(var A in B){if((A in D)&&C){D[A]=B[A]}else{D[A]=B[A]}}},$:function(A){return document.getElementById(A)},isFunction:function(A){return typeof(A)==="function"},forEach:function(A,B){var C,E,D;for(C=0,E=A.length;C<E,D=A[C];C++){if(B(D,C)===false){break}}},CallBacks:(function(){var B=function(C){var F={},D,E;C=C.split(/\s+/);for(D=0,E=C.length;D<E;D++){if(C[D].match(/(memory)|(once)/ig)){F[C[D].toLowerCase()]=true}}return F},A=function(){var C=[],U=[],D,F,E,T,S,W,X=function(N){D=N;W=T||0;T=0;S=C.length;E=true;for(;C&&W<S;W++){var M=C[W];if(!F||M.flagsOption.memory){M.handler(N);if(M.flagsOption.once){V.remove(M.handler)}}}E=false;F=true;if(C){if(U){if(U.length){X(U.shift())}}}},V={add:function(O,P){if(C){var N=C.length,M=B(O),P=P instanceof Array?P:[P];I.forEach(P,function(Q){C.push({flagsOption:M,handler:Q})});if(E){S=C.length}else{if(F){T=N;X(D)}}}return this},remove:function(M){I.forEach(C,function(N,O){if(N.handler==M){if(E){if(O<=S){S--;if(O<=W){W--}}}C.splice(O,1);return false}})},fire:function(M){if(C&&(!F||U)){if(E){U.push(M)}else{X(M)}}},clearFireState:function(){F=false}};return V};return A})(),Cookie:{getCookie:function(B){var C=";?s*"+B+"=([^;]+)",D=new RegExp(C,"ig"),A=document.cookie.match(D);if(A){return decodeURIComponent(A[0].split("=")[1])}return null},setCookie:function(B,P,F,E,A){var C=B+"="+encodeURIComponent(P);if(typeof(F)!=="undefined"){var D=new Date();var O=F*3600*1000;D.setTime(D.getTime()+O);C+="; expires="+D.toGMTString()}(!E&&(E="/"));(!A&&(A=document.domain));C+=";path="+E+";domain="+A;document.cookie=C},removeCookie:function(B){var A=new Date();A.setTime(A.getTime()-10000);document.cookie=B+"=a; expires="+A.toGMTString()}}},K=I.CallBacks(),L=I.CallBacks(),G={Utils:I,LoginOptions:{GetLoginHandlerUrl:function(){var A=location.protocol,B=A.indexOf("https")>-1?"apibaa":"api.baa",D=document.domain.indexOf("yiche.com")>-1?".yiche.com":".bitauto.com",C="/login/LoginHandler.ashx";return"//"+B+D+C},userInfoKey:null,isCheckUserStateByCookie:true,createLoginUrl:function(A){return G.LoginOptions.GetLoginHandlerUrl()+"?"+(G.LoginOptions.userInfoKey?"uinfo="+encodeURIComponent(G.LoginOptions.userInfoKey)+"&":"")+A}},extend:function(B,A){this.Utils.extend(this,B,A)},result:null,onLoginedHandlers:(function(){return{add:L.add,push:function(A){L.add("memory",A)},remove:function(A){L.remove(A)}}})(),onComplatedHandlers:(function(){return{add:K.add,push:function(A){K.add("memory",A)},remove:function(A){K.remove(A)}}})(),onBeforePostLogin:null,postLogin:function(B,A){K.clearFireState();L.clearFireState();(G.onBeforePostLogin&&G.onBeforePostLogin());G.Utils.LoadJs.ExecJs("http://js.inc.baa.bitautotech.com/c/c.js?s=Bitauto.Login.Rsa",function(){var D=new Bitauto.RSA.RSAKeyPair("010001","","AEEE48CCB2061B182180E4F42AE6684B9194A7AAFDFA04D979EB367A8BB330BE9118EEB7B1D040A1EE6D4C862A5FAE1D7AF4E76B6D4364DB8D2D364D5C9F26B8FF83DA8EB4AF8624AC2488E84DFFFAD91F3E9C5E392D2DA5BF70DE0430787CFEC5833F2CF48F8D64FBCB60B8DFB449FBFB2B27B783AB07DD4A331D4989612DB1"),F=Bitauto.RSA.EncryptedString(D,encodeURIComponent(B)),C=Bitauto.RSA.EncryptedString(D,encodeURIComponent(A)),E=G.LoginOptions.createLoginUrl("username="+F+"&userpwd="+C+"&isrsa=true&r="+Math.random()+"&returnurl="+encodeURIComponent(location.href));G.Utils.callScript(E)})},onloginComplete:function(){if(this.result){var T=this.result.auths,U=[],C=false,A=0,F=this,S=document.location.host.split("."),B=S[S.length-2],W=function(){if(G.result){K.fire(G.result)}if(G.result.isLogined||G.result.loginResult){L.fire(G.result)}},V=function(M){U.push(M);if(!C){C=M.replace(B,"").length<M.length}if(U.length===T.length){if(A>0){clearTimeout(A)}W()}},X=function(){V=function(){};W();if(C){throw new Error("load currendDomain cookieAuth of "+B+" fail")}};if(typeof([])===typeof(T)&&T.length>0){for(var D=0,E=T.length;D<E;D++){F.Utils.LoadJs.ExecJs(T[D],V)}A=setTimeout(X,2000)}else{W()}}},loadData:function(){var B=false,A;K.clearFireState();L.clearFireState();if(G.LoginOptions.isCheckUserStateByCookie){A=I.Cookie.getCookie("username");if(A&&A!="null"){B=true}}if(B){G.Utils.callScript(G.LoginOptions.createLoginUrl("r="+Math.random()))}else{Bitauto.Login.result={isLogined:false};Bitauto.Login.onloginComplete()}},init:function(){G.loadData()}};I.extend(G,J.Bitauto.Login);J.Bitauto.Login=G})(this);(function(D,C){if(typeof exports!=="undefined"){exports.NewMessageListener=C(D)}else{if(typeof define==="function"&&define.amd){define("NewMessageListener",[],function(){return C(D)})}else{D.Bitauto=D.Bitauto||{};D.Bitauto.NewMessageListener=C(D)}}})(window,function(L){var H,G,K,J,I;H={extend:function(B,A){if(!!A){for(var C in B){if(A[C]){if(typeof A[C]==="object"){B[C]=extend(B[C],A[C])}else{B[C]=A[C]}}}}return B},guidGenerator:function(){var A=function(){return(((1+Math.random())*65536)|0).toString(16).substring(1)};return(A()+A()+"-"+A()+"-"+A()+"-"+A()+"-"+A()+A()+A())},execFuncArrary:function(E,A,B){B=B?B:this;if(E&&E.length){for(var D=0,C=E.length;D<C;D++){E[D].apply(B,Array.prototype.slice.call(arguments,1))}}},cloneEvents:function(B){var A={};for(var C in B){A[C]=B[C].concat()}return A},getIndexOfArr:function(B,D){var C=0,A=D;for(;C<A;C++){if(B===D[C]){return C}}return -1}};J=(function(){var B=document.getElementsByTagName("head")[0],C=[],D=function(Q,R){var P=H.guidGenerator(),F=this.scriptElm=document.createElement("script");F.setAttribute("type","text/javascript");F.setAttribute("src","http://api.baa.bitauto.com/ibt/GetNewMessageState.ashx?key="+P+"&callback=NewMessageListenerCallBack");F.setAttribute("charset","UTF-8");F.onload=F.onreadystatechange=function(){if(!this.readyState||"loaded"===F.readyState||"complete"===F.readyState){this.parentNode.removeChild(this)}};C.push({key:P,func:Q,context:R});B.appendChild(F)},E=function(O){var P,F;for(P=0,F=C.length;P<F;P++){if(C[P].key===O){return P}}return -1},A=function(F){var P=E(F.key),O=P<0?null:C[P];if(O){O.func.call(O.context,F);C.splice(P,1)}};L.NewMessageListenerCallBack=A;return{create:D,onLoadName:"onLoaded"}})();G={Error:0,NoLogin:1,NewMsg:2,NoNewMsg:3};I=function(B,A){if(!(this instanceof I)){return new I(B)}this.options=H.extend({mediatorInterval:true,interval:5000},B);this.eventsContainer=H.extend({"NewMessage":[],"Error":[],"NoLogin":[],"NoNewMessage":[],"RequestComplated":[]},A)};I.prototype.on=function(B,A){var C;if(typeof B==="string"&&this.eventsContainer.hasOwnProperty(B)&&(A instanceof Array||typeof A==="function")){C=this.eventsContainer[B];if(!(C instanceof Array)){C=[]}this.eventsContainer[B]=C.concat(A)}};I.prototype.off=function(E,A){var D;if(typeof E==="string"&&this.eventsContainer.hasOwnProperty(E)){D=this.eventsContainer[E];if(!A){this.eventsContainer[E]=[]}else{if(A instanceof Array){for(var P=0,B=0,C=D.length,F=A.length;P<C;P++){for(;B<F;B++){if(D[P]===A[B]){D.splice(P,1)}}}}else{if(typeof A=="function"){for(var P=0,O=D.length;P<O;P++){if(D[P]===A){D.splice(P,1);break}}}}}}};I.prototype.run=function(B){var A=H.cloneEvents(this.eventsContainer),C=typeof B==="boolean"?B:this.options.mediatorInterval;J.create(function(E){var D,F=this;if(E.state){switch(E.state){case G.Error:D=A["Error"];break;case G.NewMsg:D=A["NewMessage"];break;case G.NoLogin:D=A["NoLogin"];break;case G.NoNewMsg:D=A["NoNewMessage"];break}}else{D=A["Error"]}H.execFuncArrary(D.concat(A["RequestComplated"]),E,this);if(C){this.intervalId=setTimeout(function(){F.run(B)},this.options.interval)}},this)};I.prototype.stop=function(A){if(arguments.length>0){this.options.mediatorInterval=!A}if(this.intervalId>0){clearTimeout(this.intervalId)}};return I});(function(){Bitauto.Login.onLoginedHandlers.push(function(H){var I=document.cookie,G,F,J;if(!H.loginResult||(H.loginResult&&!Bitauto.Login.isNeedRefresh)){if(I.indexOf("UserBorsingHistory"+Bitauto.Login.result.userId)===-1){G=new Date();G.setTime(G.getTime()+1000*60*30);F=location.host.split(".");J=F[F.length-2]+"."+F[F.length-1];document.cookie="UserBorsingHistory"+H.userId+"="+new Date().getTime()+";expires="+G+";path=/;domain="+J;Bitauto.Login.Utils.callScript("http://api.baa.bitauto.com/ibt/RecordBrowse.ashx?r="+Math.random())}}})})();(function(J){var G=J.Bitauto,I=J.lazyT,H=I.tmpl('{#? !D.isLogined #}<a href="http://i.m.yiche.com/authenservice/login.html?returnurl={#=encodeURI(document.location.href)#}" class="yiche-logout"><span class="user-name">请登录</span><span class="user-out"></span></a>{#?? #}<a href="http://i.m.yiche.com/u{#=D.userId #}/" class="yiche-login"><span class="user-name">{#=(D.showName || D.userName) #}</span><span class="user-in"><img src="{#=D.avatar60 #}"/><i id="newMsgIcon" style="display:none;"></i></span></a>{#? #}'),F=document.getElementById("ibt_LoginContainer");G.Login.LoginOptions.userInfoKey="avatar60";G.Login.onComplatedHandlers.push(function(A){if(F){F.innerHTML=H(A)}});G.Login.onLoginedHandlers.add("once",function(A){if(F){var B=new G.NewMessageListener({mediatorInterval:true,interval:30000});B.on("RequestComplated",function(M){var D=document.getElementById("newMsgIcon"),N,C,E;if(M.state===2){E=0;for(N=0,C=M.msgdata.length;N<C;N++){E=E+M.msgdata[N].Value}if(E>99){E="99+"}}if(E){D.innerHTML=E.toString();D.style.display=""}else{D.style.display="none"}});B.run()}});G.Login.init()})(window);var Bitauto=Bitauto||{};Bitauto.GoBacker=(function(){var I=null,J="http://m.yiche.com",M=function(A){I=A},K=function(A){J=A},H=function(C,A,B){if(C.addEventListener){C.addEventListener(A,B,false)}else{if(C.attchEvent){C.attchEvent("on"+A,function(D){return B.call(C,D)})}else{C["on"+A]=B}}},N=function(C,A,B){if(C.addEventListener){C.removeEventListener(A,B,true)}else{if(C.attchEvent){C.detacheEvent("on"+A,B)}else{C["on"+A]=null}}},L=function(){var A;if(typeof I==="function"){A=I()}else{if(typeof I==="string"){A=I}}if(A){location.href=A}else{if(history.length>1&&document.referrer.length>0&&document.referrer.match(/^http:\/\/([\w]+\.)*(bitauto|yiche|qichetong|taoche|leche|maichebao|huimaiche)\.com/ig)){window.history.back()}else{if(document.referrer.length>0&&document.referrer.match(/^http:\/\/([\w]+\.)*(bitauto|yiche|qichetong|taoche|leche|maichebao|huimaiche)\.com/ig)){location.href=document.referrer}else{location.href=J}}}};return{setCustomURL:M,setDefaultURL:K,goBack:L,goBackByElementEvent:function(C,B){var A=document.getElementById(C);if(A){H(A,B,L)}},removeElementGoBackEvent:function(C,B){var A=document.getElementById(C);if(A){N(A,B,L)}}}})();(function(W,V){var O={linkTargetId:"a_linkToPcPage",eventName:"click",customUrl:null};var N=V.getElementById(O.linkTargetId),Q="http://www.bitauto.com/views/wap/go.aspx?url=";if(N){X()}function S(B){B=B||{};for(var A in B){O[A]=B[A]}N=V.getElementById(O.linkTargetId);if(N){X()}}function X(){T(N,O.eventName,R);P(N,O.eventName,R)}function M(A){O.customUrl=A}function U(){if("string"===typeof O.customUrl){location.href=Q+encodeURIComponent(O.customUrl)}else{if("function"===typeof O.customUrl){location.href=Q+encodeURIComponent(O.customUrl())}else{if("object"===O.customUrl&&"function"===typeof O.customUrl.func){var A;if(!!O.customUrl.context){A=O.customUrl.func.call(O.customUrl.context)}else{A=O.customUrl.func()}location.href=Q+encodeURIComponent(A)}}}}function R(){if(!!O.customUrl){U()}else{var A=location.href,B=Q;if(A.indexOf("m.yiche")>-1){B+=encodeURIComponent(A.replace("m.yiche","yiche"))}else{if(A.indexOf("m.qichetong")>-1){B+=encodeURIComponent(A.replace("m.","i."))}else{if(A.indexOf("m.bitauto")>1){B+=encodeURIComponent(A.replace("m.",""))}}}location.href=B}}function P(B,C,A){if(B.addEventListener){B.addEventListener(C,A,false)}else{if(B.attchEvent){B.attchEvent("on"+C,function(D){return A.call(B,D)})}else{B["on"+C]=A}}}function T(B,C,A){if(B.addEventListener){B.removeEventListener(C,A,true)}else{if(B.attchEvent){B.detacheEvent("on"+C,A)}else{B["on"+C]=null}}}W.PcPager={bind:S,setCustomUrl:M}})(window,document);